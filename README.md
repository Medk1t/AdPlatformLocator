# AdPlatformLocator - Веб-сервис рекламных площадок

Этот проект представляет собой ASP.NET Core Web API сервис для управления информацией о рекламных площадках и их поиска по локации. Данные хранятся в оперативной памяти для обеспечения высокой производительности операций поиска.

## Содержание

* [Требования](#требования)
* [Как запустить сервис](#как-запустить-сервис)
* [Использование API](#использование-api)
    * [Загрузка данных (POST /api/upload)](#загрузка-данных-post-apiupload)
    * [Поиск данных (GET /api/search)](#поиск-данных-get-apisearch)
* [Тестовые данные](#тестовые-данные)
* [Структура проекта](#структура-проекта)
* [Юнит-тесты](#юнит-тесты)

---

## Требования

* [.NET SDK 9.0](https://dotnet.microsoft.com/download/dotnet/9.0) или выше.

## Как запустить сервис

Выполните следующие шаги для запуска веб-сервиса:

1.  **Клонируйте репозиторий (если еще не сделали это):**
    ```bash
    git clone https://github.com/Medk1t/AdPlatformLocator.git
    cd AdPlatformLocator
    ```
    (Замените `https://github.com/Medk1t/AdPlatformLocator.git` на фактический URL вашего GitHub репозитория.)

2.  **Перейдите в директорию проекта:**
    Убедитесь, что вы находитесь в корневой директории проекта `AdPlatformLocator` (где находится файл `Program.cs` и `AdPlatformLocator.csproj`).

3.  **Запустите приложение:**
    ```bash
    dotnet run
    ```
    После запуска в консоли будет показан адрес, на котором запущен сервис (например, `https://localhost:7001`).

## Использование API

Сервис предоставляет два REST API эндпоинта. Для удобства тестирования вы можете использовать `Swagger UI`.

### Загрузка данных (POST /api/upload)

* **URL:** `POST /api/upload`
* **Тип контента:** `text/plain`
* **Тело запроса:** Содержимое текстового файла с данными о рекламных площадках. Каждая строка должна содержать название площадки и список локаций, разделенных двоеточием (`:`), а локации - запятыми (`,`).
* **Пример тела запроса:**
    ```
    Яндекс.Директ: /ru
    Ревдинский рабочий:/ru/svrd/revda,/ru/svrd/pervik
    Газета уральских москвичей: /ru/msk,/ru/permobl,/ru/chelobl
    Крутая реклама: /ru/svrd
    ```
* **Ответ:** `HTTP 200 OK` в случае успеха, `HTTP 400 Bad Request` или `HTTP 500 Internal Server Error` в случае ошибки.

**Как отправить запрос с `curl`:**
(Убедитесь, что файл `ad_data.txt` находится в той же директории, откуда вы запускаете команду.)

```bash
curl -X POST "https://localhost:7206/api/upload" \
     -H "Content-Type: text/plain" \
     --data-binary "@ad_data.txt" \
     --insecure # Используйте, если есть проблемы с сертификатами HTTPS на localhost
```

### Поиск данных (GET /api/search)

* **URL:** `GET /api/search`
* **Параметры запроса:**
    * `location` (строка, **обязательный**): Локация, для которой
        нужно найти рекламные площадки (например, `/ru/msk`).
* **Ответ:** `HTTP 200 OK` со списком названий рекламных
    площадок в формате JSON, `HTTP 400 Bad Request` или
    `HTTP 500 Internal Server Error` в случае ошибки.
* **Пример ответа (для `/ru/svrd/revda`):**
    ```json
    [
      "Яндекс.Директ",
      "Ревдинский рабочий",
      "Крутая реклама"
    ]
    ```

**Как отправить запрос с `curl`:**

```bash
curl -X GET "https://localhost:7206/api/search?location=/ru/svrd/revda" \
     --insecure # Используйте, если есть проблемы с сертификатами HTTPS на localhost
```

## Тестовые данные

Вы можете использовать следующее содержимое для файла `ad_data.txt` для загрузки через метод `POST /api/upload`. Просто скопируйте этот текст:

```
Яндекс.Директ: /ru
Ревдинский рабочий:/ru/svrd/revda,/ru/svrd/pervik
Газета уральских москвичей: /ru/msk,/ru/permobl,/ru/chelobl
Крутая реклама: /ru/svrd
Тестовая площадка:/test/location1,/test/location2
Некорректная строка без двоеточия
Площадка без локаций:
Площадка с пустыми локациями: , ,
```

## Структура проекта

* AdPlatformLocator/
   * `AdPlatformLocator.csproj`: Файл проекта.
   * `Program.cs`: Точка входа в приложение, настройка Dependency Injection.
   * `Services/AdPlatformService.cs`: Основная бизнес-логика:
    загрузка, хранение и поиск данных в памяти.
   * `Controllers/AdPlatformController.cs`: REST API контроллер,
    обрабатывающий HTTP-запросы.
* AdPlatformLocator.Tests/
   * `AdPlatformTests.cs`: Юнит-тесты для `AdPlatformLocator`.

## Юнит-тесты

Для запуска юнит-тестов перейдите в корневую директорию проекта и выполните следующие команды:

```bash
cd AdPlatformLocator.Tests
dotnet test
```
